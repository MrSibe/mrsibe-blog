{{- /* 性能优化：预连接关键资源 */ -}}
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="dns-prefetch" href="https://analytics.ahrefs.com">
<link rel="dns-prefetch" href="https://www.googletagmanager.com">

{{- /* Google Fonts - 优化加载策略（异步加载，避免阻塞渲染，仅加载必要字重） */ -}}
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:wght@400;600&family=JetBrains+Mono:wght@400&family=Noto+Serif+SC:wght@400;600&display=swap" media="print" onload="this.media='all';this.onload=null">
<noscript>
  <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:wght@400;600&family=JetBrains+Mono:wght@400&family=Noto+Serif+SC:wght@400;600&display=swap" rel="stylesheet">
</noscript>

{{- /* 智能隐藏/显示顶部导航栏样式 */ -}}
{{ $smartHeaderStyle := resources.Get "css/extended/smart-header.css" }}
{{ if $smartHeaderStyle }}
<link rel="stylesheet" href="{{ $smartHeaderStyle.RelPermalink }}">
{{ end }}

{{- /* Ahrefs Web Analytics - 改用 defer 提升性能 */ -}}
{{- if hugo.IsProduction | or (eq site.Params.env "production") }}
<script src="https://analytics.ahrefs.com/analytics.js" data-key="+l1xGejnsYdzsQ6GXnMjjw" defer></script>
{{- end }}

{{- /* SEO 增强 Meta 标签 */ -}}
<meta name="format-detection" content="telephone=no">
<meta name="theme-color" content="#2e2e33" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#fdfbf7" media="(prefers-color-scheme: light)">

{{- /* 友链页面专用样式 */ -}}
{{- if eq .Type "friends" }}
{{ $friendsStyle := resources.Get "css/extended/friends.css" }}
{{ if $friendsStyle }}
<link rel="stylesheet" href="{{ $friendsStyle.RelPermalink }}">
{{ end }}
{{- end }}
