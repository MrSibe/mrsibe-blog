{{- /* 基于 PaperMod 主题修改，添加搜索模态框 2024-12-28 */ -}}
{{- if lt hugo.Version "0.146.0" }}
{{- errorf "=> hugo v0.146.0 or greater is required for hugo-PaperMod to build " }}
{{- end -}}

<!DOCTYPE html>
{{- $theme := site.Params.defaultTheme | default "auto" }}
{{- if eq $theme "dark" }}
<html lang="{{ site.Language }}" dir="{{ .Language.LanguageDirection | default " auto" }}" data-theme="dark">
{{- else if eq $theme "light" }}
<html lang="{{ site.Language }}" dir="{{ .Language.LanguageDirection | default " auto" }}" data-theme="light">
{{- else }}
<html lang="{{ site.Language }}" dir="{{ .Language.LanguageDirection | default " auto" }}" data-theme="auto">
{{- end }}

<head>
    {{- partial "head.html" . }}
</head>

{{- if (or (ne .Kind `page` ) (eq .Layout `archives`) (eq .Layout `search`)) }}

<body class="list" id="top">
    {{- else }}

    <body id="top">
        {{- end }}
        {{ partialCached "header.html" . .Page -}}

        {{- /* 判断是否需要显示侧边栏 */ -}}
        {{- $hideSidebar := or (eq .Layout "archives") (eq .Type "categories") (eq .Type "tags") (in .RelPermalink "/links/") (eq .Type "posts") -}}

        {{- if eq .Kind "home" }}
            {{- /* 首页特殊布局：欢迎信息全宽 + 下方三列布局 */ -}}
            {{- /* 欢迎信息 - 全宽显示 */ -}}
            <div class="home-hero-wrapper">
                {{- partial "home_info.html" . }}
            </div>

            {{- /* 下方内容 - 三列布局 */ -}}
            <div class="main-wrapper">
                {{- /* 左侧边栏：个人简介 */ -}}
                {{- partialCached "sidebar-left.html" . .Site.Lastmod -}}

                {{- /* 主内容区域 */ -}}
                <main class="main">
                    {{- block "main" . }}{{ end }}
                </main>
            </div>
        {{- else if $hideSidebar }}
            {{- /* 归档、分类、标签、友链页面：不显示侧边栏 */ -}}
            <main class="main">
                {{- block "main" . }}{{ end }}
            </main>
        {{- else }}
            {{- /* 其他页面：显示三列布局 */ -}}
            <div class="main-wrapper">
                {{- /* 左侧边栏：个人简介 */ -}}
                {{- partialCached "sidebar-left.html" . .Site.Lastmod -}}

                {{- /* 主内容区域 */ -}}
                <main class="main">
                    {{- block "main" . }}{{ end }}
                </main>
            </div>
        {{- end }}

        {{ partialCached "footer.html" . .Layout .Kind (.Param "hideFooter") (.Param "ShowCodeCopyButtons") -}}

        {{- /* 搜索模态框 */ -}}
        {{- if not site.Params.disableSearch }}
        {{- partial "search_modal.html" . -}}
        {{- end }}

        {{- /* 扩展的 footer 部分（自定义脚本） */ -}}
        {{- partial "extend_foot.html" . -}}
    </body>

</html>